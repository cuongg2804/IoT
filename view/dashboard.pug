doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    title ESP System Control
    link(rel="stylesheet", href="/style.css")
  body
    h1 ESP System Control

    // Controls
    .controls
      button(onclick="sendCmd('ON')") B·∫≠t
      button(onclick="sendCmd('OFF')") T·∫Øt
      button(onclick="sendCmd('STOP')") D·ª´ng kh·∫©n c·∫•p

    // System status
    .status
      p Tr·∫°ng th√°i: 
        span#systemStatus Ch∆∞a k·∫øt n·ªëi...
      .colorCounters
        span#countXanh.badge.xanh Xanh: 0
        span#countDo.badge.do ƒê·ªè: 0
        span#countVang.badge.vang V√†ng: 0

    // Session table
    h2 Th·ªëng k√™
    table#sessionTable.session-table
      thead
        tr
          th #
          th B·∫Øt ƒë·∫ßu
          th K·∫øt th√∫c
          th Th·ªùi gian
          th Xanh
          th ƒê·ªè
          th V√†ng
          th T·ªïng
          th
      tbody
        each session, index in sessionList
          - const start = new Date(session.startAt)
          - const end = new Date(session.endAt)
          - const durationSec = Math.floor((end - start) / 1000)
          - const durationStr = `${Math.floor(durationSec / 60)}m ${durationSec % 60}s`
          - const total = session.totalBlue + session.totalRed + session.totalGreen
          tr
            td #{index + 1}
            td #{start.toLocaleString()}
            td #{end.toLocaleString()}
            td #{durationStr}
            td #{session.totalBlue}
            td #{session.totalRed}
            td #{session.totalGreen}
            td #{total}
            td
              button.view-btn(onclick=`viewSession('${session._id}')`) üîç

    // Scripts
    script(src="/socket.io/socket.io.js")
    script(src="https://unpkg.com/mqtt/dist/mqtt.min.js")
    script(src="/script.js")
